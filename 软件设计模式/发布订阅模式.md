# 发布订阅模式
### 模式的定义
- 发布订阅模式，属于行为型模式。它定义了对象间的一种一对多的关系，让多个观察者对象同时监听某一个主题对象，当一个对象发生改变时，所有依赖于它的对象都将得到通知。

### 模式的结构
<br />
<img src="http://zhangzqcloud.cn/file-images/%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85%E8%80%85%E6%A8%A1%E5%BC%8F.png" title="发布订阅模式" width="600px" height="400px">

- 发布订阅模式中包含的角色
   - publisher,发布者
   - Subscribers，订阅者

### 模式的优点
1. 松耦合，可以将众多需要通信的子系统解耦，每个子系统都可以独立管理。而且即使部分子系统下线了，也不会影响系统消息的整体管理。发布者与订阅者之间没有直接关联。
2. 高伸缩性，发布者可以快速地向输入通道发送一条消息，然后返回到其核心处理职责，而不必等待子系统处理完成。然后消息传递的基础结构负责确保把消息传递到每个订阅者手里。
3. 高可靠性，异步的消息传递有助于应用程序在增加的负载下继续平稳运行，并且可以更有效地处理间歇性故障。
4. 灵活性，允许延迟处理或者按计划的处理。例如当系统负载大的时候，订阅者可以等到非高峰时间才接收消息，或者根据特定的计划处理消息。
5. 可测试性，通道可以被监视，消息可以作为整体集成测试策略的一部分而被检查或记录。

### 模式作用的场景
1. 程序需要向大量的订阅者发布信息。
2. 程序需要与一个或多个独立开发的应用程序或服务通信，这些应用程序或服务可能使用不同的平台、编程语言和通信协议。
3. 程序可以向消费者发送信息，而不需要消费者的实时响应。

## 发布订阅模式与观察者模式的差异
<br />
<img src="http://zhangzqcloud.cn/file-images/%E5%8F%91%E5%B8%83%E8%80%85%E6%A8%A1%E5%BC%8F%E4%B8%8E%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F.png" title="发布者模式与观察者模式" width="400px" height="600px">

1. 在订阅发布模式中，发布者与订阅者是完全分离的、完全解耦的，发布者不会直接通知订阅者，而是通过第三方去通知订阅者。而在观察者模式中，发布者与订阅者的关系是
松耦合。
2. 订阅发布模式中，主要是以异步方式实现的，使用了消息队列。观察者模式采用的是同步方式。


- 参考：
   - [一文搞懂发布订阅模式](https://juejin.im/post/5cc9ccfff265da03474e1042#heading-0)
