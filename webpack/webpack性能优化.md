# webpackæ€§èƒ½ä¼˜åŒ–
## å¼€å‘ç¯å¢ƒæ€§èƒ½ä¼˜åŒ–
- ä¼˜åŒ–æ‰“åŒ…æ„å»ºé€Ÿåº¦
- ä¼˜åŒ–ä»£ç è°ƒè¯•

## ç”Ÿäº§ç¯å¢ƒæ€§èƒ½ä¼˜åŒ–
- ä¼˜åŒ–æ‰“åŒ…æ„å»ºé€Ÿåº¦
- ä¼˜åŒ–ä»£ç è¿è¡Œçš„æ€§èƒ½

### å¼€å‘ç¯å¢ƒä¸­ä¼˜åŒ–æ‰“åŒ…æ„å»ºé€Ÿåº¦-HMR
- HMR(æ¨¡å—çƒ­æ›¿æ¢)ä½œç”¨ï¼šå½“ä¸€ä¸ªæ¨¡å—å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåªä¼šé‡æ–°æ‰“åŒ…è¿™ä¸€ä¸ªæ¨¡å—ï¼Œè€Œä¸æ˜¯é‡æ–°æ‰“åŒ…æ‰€æœ‰æ¨¡å—ï¼Œè¿™æ ·ä¼šæå¤§åœ°æå‡æ„å»ºçš„é€Ÿåº¦ã€‚
- htmlæ–‡ä»¶é»˜è®¤ä¸èƒ½ä½¿ç”¨HRMåŠŸèƒ½ï¼ŒåŒæ—¶è¿˜ä¼šå¯¼è‡´htmlæ–‡ä»¶ä¸èƒ½çƒ­æ›´æ–°ã€‚
   - htmlæ–‡ä»¶ä¸éœ€è¦HRMåŠŸèƒ½ï¼Œå› ä¸ºhtmlæ–‡ä»¶åªæœ‰ä¸€ä¸ªï¼Œè‹¥è¿™ä¸ªæ¨¡å—æ”¹å˜äº†ï¼Œå¿…ç„¶è¦é‡æ‰“åŒ…ã€‚
   - ä¸èƒ½çƒ­æ›´æ–°çš„è§£å†³æ–¹æ³•ï¼šä¿®æ”¹entryå…¥å£ï¼Œå¹¶å°†htmlæ–‡ä»¶å¼•å…¥ã€‚
   ```
   entryï¼š['./src/js/index.js','./src/index.html']
   ```
- jsæ–‡ä»¶é»˜è®¤ä¸èƒ½ä½¿ç”¨HMRåŠŸèƒ½ï¼Œjsæ–‡ä»¶çš„HRMåŠŸèƒ½åªèƒ½å¤„ç†éå…¥å£jsæ–‡ä»¶ã€‚
   - è§£å†³æ–¹æ³•ï¼šä¿®æ”¹jsä»£ç ï¼Œæ·»åŠ æ”¯æŒHRMåŠŸèƒ½
   ```
   //åœ¨å…¥å£çš„jsæ–‡ä»¶ä¸­æ·»åŠ 
   //å…¨å±€å¯»æ‰¾moduleï¼Œå¹¶ä¸”æŸ¥çœ‹æ˜¯å¦æœ‰hotå±æ€§ï¼Œè‹¥hotå±æ€§çš„å€¼ä¸ºtrueï¼Œè¯´æ˜å¼€å¯äº†HMRåŠŸèƒ½
    if(module.hot){
    //è¯¥æ–¹æ³•ä¼šç›‘å¬print.jsæ–‡ä»¶çš„å˜åŒ–ï¼Œä¸€æ—¦å‘ç”Ÿäº†å˜åŒ–ï¼Œå…¶ä»–jsæ–‡ä»¶ä¸ä¼šé‡æ–°æ‰“åŒ…æ„å»ºï¼Œå¹¶æ‰§è¡Œå›è°ƒå‡½æ•°ã€‚
      module.hot.accept('./print.js',function(){
      })
    }
   
   ```
- æ ·å¼æ–‡ä»¶å¯ä»¥ä½¿ç”¨HMRåŠŸèƒ½ï¼Œå› ä¸ºåœ¨style-loaderä¸­å†…éƒ¨å®ç°äº†è¯¥åŠŸèƒ½ã€‚
```
var path = require('path');

module.exports = {
  //...
  devServer: {
    contentBase: path.join(__dirname, 'dist'),  //contentBaseæŒ‡å®šåœ¨å“ªä¸ªç›®å½•å¯åŠ¨æœåŠ¡
    compress: true, //å‹ç¼©
    port: 9000, //ç«¯å£
    hot: true //å¯åŠ¨çƒ­æ›¿æ¢
  }
};
```

### å¼€å‘ç¯å¢ƒä¸­ä¼˜åŒ–è°ƒè¯•ä»£ç -source-map
- source-mapï¼šä¸€ç§æä¾›æºä»£ç åˆ°æ„å»ºåä»£ç æ˜ å°„æŠ€æœ¯(è‹¥æ„å»ºåä»£ç å‡ºé”™äº†ï¼Œå¯ä»¥é€šè¿‡æ˜ å°„è¿½è¸ªåˆ°æºä»£ç çš„é”™è¯¯)ã€‚
   - [inline-|hidden-|eval-][nosources-][cheap-[module-]]source-map
      1. source-map:å¤–éƒ¨ï¼Œå¯ä»¥æä¾›é”™è¯¯ä»£ç çš„å‡†ç¡®ä¿¡æ¯ä»¥åŠæºä»£ç çš„é”™è¯¯ä½ç½®ã€‚
      2. inline-source-map:å†…è”ï¼Œå†…è”ç›¸å¯¹äºå¤–éƒ¨ï¼Œä¸ä¼šå¦å¤–ç”Ÿæˆ.mapæ–‡ä»¶ï¼Œç›´æ¥å†…è”åˆ°è¾“å‡ºçš„jsæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”å†…è”æ„å»ºçš„é€Ÿåº¦æ›´å¿«ã€‚
      å¹¶ä¸”å¯ä»¥æä¾›é”™è¯¯ä»£ç çš„å‡†ç¡®ä¿¡æ¯ä»¥åŠæºä»£ç çš„é”™è¯¯ä½ç½®ã€‚
      3. hidden-source-map:å¤–éƒ¨ï¼Œå¯ä»¥æä¾›é”™è¯¯ä»£ç çš„å‡†ç¡®ä¿¡æ¯ï¼Œä½†æ˜¯æ— æ³•æä¾›æºä»£ç çš„é”™è¯¯ä½ç½®ï¼Œåªèƒ½æä¾›æ„å»ºåä»£ç çš„é”™è¯¯ä½ç½®ã€‚
      4. eval-source-mapï¼šå†…è”ï¼Œå¯ä»¥æä¾›é”™è¯¯ä»£ç çš„å‡†ç¡®ä¿¡æ¯ä»¥åŠæºä»£ç çš„é”™è¯¯ä½ç½®ã€‚
         -  inline-source-mapä¸eval-source-mapåŒºåˆ«ï¼šinline-source-mapåªä¼šç”Ÿæˆä¸€ä¸ªå†…è”source-mapï¼Œè€Œeval-source-mapåœ¨æ¯ä¸ªæ–‡ä»¶ä¸­éƒ½ç”Ÿæˆ
         å¯¹åº”çš„source-mapï¼Œå¹¶ä¸”éƒ½åœ¨evalå‡½æ•°ä¸­ã€‚
      5. nosources-source-mapï¼šå¤–éƒ¨ï¼Œå¯ä»¥æä¾›é”™è¯¯ä»£ç çš„å‡†ç¡®ä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰æºä»£ç å’Œæ„å»ºåä»£ç ä¿¡æ¯(ä¸ºäº†éšè—ä»£ç )ã€‚
      6. cheap-source-mapï¼šå¤–éƒ¨ï¼Œå¯ä»¥æä¾›é”™è¯¯ä»£ç çš„å‡†ç¡®ä¿¡æ¯ä»¥åŠæºä»£ç çš„é”™è¯¯ä½ç½®(åªç²¾ç¡®åˆ°é”™è¯¯è¡Œ)ã€‚
      7. cheap-module-source-mapï¼šå¤–éƒ¨ï¼Œå¯ä»¥æä¾›é”™è¯¯ä»£ç çš„å‡†ç¡®ä¿¡æ¯ä»¥åŠæºä»£ç çš„é”™è¯¯ä½ç½®(åªç²¾ç¡®åˆ°é”™è¯¯è¡Œ)ã€‚
         - ä¸cheap-source-mapåŒºåˆ«ï¼šmoduleä¼šå°†loaderçš„source mapåŠ å…¥
- åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œè¦æ±‚ï¼šé€Ÿåº¦å¿«ï¼Œè°ƒè¯•å‹å¥½åº¦ã€‚
   - é€Ÿåº¦(eval>inline>cheap>...)ï¼ševal-cheap-source-map>eval-source-map
   - å‹å¥½åº¦ï¼šsource-map>cheap-module-source-map>cheap-source-map
   - æœ€ç»ˆï¼ševal-source-map / eval-cheap-module-source-map
- åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè¦æ±‚ï¼šæ˜¯å¦éšè—æºä»£ç ä»¥åŠè°ƒå¼å‹å¥½åº¦ã€‚
   - å†…è”ä¼šè®©ä»£ç ä½“ç§¯å˜å¤§ï¼Œæ‰€ä»¥ä¸€èˆ¬åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¸ä½¿ç”¨å†…è”ã€‚
   - è‹¥ä¸éœ€è¦éšè—æºä»£ç ï¼Œå¯ä»¥ä½¿ç”¨source-map / cheap-module-source-map
   - è‹¥éœ€è¦éšè—æºä»£ç ï¼Œåˆ™ä½¿ç”¨hidden-source-map/nosources-source-map
```
var path = require('path');

module.exports = {
  //...
  devtool:'source-map'
};
```

### ç”Ÿäº§ç¯å¢ƒæ€§èƒ½ä¼˜åŒ–-oneOf
- oneOfï¼šæå‡æ„å»ºé€Ÿåº¦ã€‚
```
ğŸŒ°ï¼š
 module: {
        rules: [
        //ï¼åœ¨oneOfä¸­ä¸èƒ½æœ‰ä¸¤ä¸ªé…ç½®å¤„ç†åŒä¸€ç§ç±»å‹æ–‡ä»¶ï¼Œæ‰€ä»¥è¦å°†å…¶ä¸­ä¸€ä¸ªé…ç½®jsçš„loaderè°ƒå‡ºoneOfï¼
            {
                test: /\.js$/,
                exclude: '/node_module/',
                //ä¼˜å…ˆæ‰§è¡Œ
                enforce: 'pre',
                //ä½¿ç”¨eslintè¯­æ³•æ£€æŸ¥
                loader: 'eslint-loader',
                options: {
                    //è‡ªåŠ¨ä¿®å¤eslintçš„é”™è¯¯
                    fix: true
                }
            },
            {
                //åªä¼šåŒ¹é…ä¸€ä¸ªloader,åŒ¹é…åˆ°ä¸€ä¸ªåå°±ä¸ä¼šç»§ç»­å¾€ä¸‹åŒ¹é…ï¼Œæ›´é«˜æ€§èƒ½
                oneOf: [
                    {
                        test: /\.css$/,
                        use: [...commonCss]
                    },
                    {
                        test: /\.less$/,
                        use: [
                            ...commonCss,
                            "less-loader"
                        ]

                    },
                    {
                        test: /\.js$/,
                        exclude: '/node_module/',
                        //ä¼˜å…ˆæ‰§è¡Œ
                        enforce: 'pre',
                        //ä½¿ç”¨eslintè¯­æ³•æ£€æŸ¥
                        loader: 'eslint-loader',
                        options: {
                            //è‡ªåŠ¨ä¿®å¤eslintçš„é”™è¯¯
                            fix: true
                        }
                    },
                    {
                        test: /\.js$/,
                        exclude: /node_modules/,
                        //å¤„ç†jså…¼å®¹æ€§çš„é—®é¢˜
                        loader: 'babel-loader',
                        options: {
                            //å¯¹babelè¿›è¡Œé¢„è®¾
                            presets: [['@babel/preset-env', {
                                //æŒ‰éœ€åŠ è½½
                                useBuiltIns: 'usage',
                                //æŒ‡å®šcore-jsçš„ç‰ˆæœ¬
                                corejs: {
                                    version: 3
                                },
                                //æŒ‡å®šå…¼å®¹æ€§å…¼å®¹åˆ°å“ªä¸ªç‰ˆæœ¬çš„æµè§ˆå™¨
                                targets: {
                                    chrome: '60',
                                    firefox: '60',
                                    ie: '9',
                                    safari: '10'
                                }
                            }]]
                        }
                    },
                    {
                        //å¯¹å›¾ç‰‡è¿›è¡Œå¤„ç†
                        test: /\.(jpg|png|gif)/,
                        loader: 'url-loader',
                        options: {
                            limit: 8 * 1024,
                            name: '[hash:10].[ext]',
                            //å…³é—­es6æ¨¡å—åŒ–
                            esModule: false,
                            //æŒ‡å®šè¾“å‡ºè·¯å¾„
                            outputPath: 'imgs'
                        }
                    },
                    {
                        //å¤„ç†htmlæ–‡ä»¶
                        test: /\.html$/,
                        use: [
                            'html-loader'
                        ]
                    },
                    {
                        //å¤„ç†å…¶ä»–æ–‡ä»¶
                        exclude: /.(html|css|less|jpg|png|gitf|js)/,
                        loader: 'file-loader'
                    }
                ]
            }
        ]
    }
```

