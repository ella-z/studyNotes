# Event Loop
### Event Loopæ˜¯ä»€ä¹ˆ
- Event loopæ˜¯äº‹ä»¶å¾ªçŽ¯æœºåˆ¶ã€‚

### ä¸ºä»€ä¹ˆè¦ç”¨Event Loop
- å› ä¸ºJavaScriptæ˜¯ä¸€ç§å•çº¿ç¨‹çš„è¯­è¨€ï¼Œæ‰€æœ‰çš„ä»»åŠ¡éƒ½åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸Šå®Œæˆï¼Œæ‰€ä»¥ä»»åŠ¡åœ¨æ‰§è¡Œæ—¶é‡‡ç”¨çš„æ˜¯æŽ’é˜Ÿè¿™ç§æ–¹æ³•ï¼Œåªæœ‰ç­‰å‰é¢çš„ä»»åŠ¡å®ŒæˆåŽï¼Œæ‰èƒ½æ‰§è¡ŒåŽé¢çš„ä»»åŠ¡ã€‚å¦‚æžœé‡åˆ°å¤§é‡ä»»åŠ¡æˆ–è€…é‡åˆ°ä¸€ä¸ªè€—æ—¶çš„ä»»åŠ¡ï¼Œåœ¨è¿™ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆä¹‹å‰ï¼ŒåŽé¢çš„ä»»åŠ¡éƒ½æ— æ³•æ‰§è¡Œï¼Œéœ€è¦ä¸€ç›´ç­‰åˆ°è¿™ä¸ªä»»åŠ¡å®Œæˆæ‰èƒ½æ‰§è¡Œï¼ŒEvent Loopå°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

### Event Loopè¿™ç§æœºåˆ¶æ˜¯å¦‚ä½•è¿è¡Œçš„
- å°†ä»»åŠ¡åˆ†ä¸ºä¸¤ç§ç±»åž‹ï¼š
   - åŒæ­¥ä»»åŠ¡
   - å¼‚æ­¥ä»»åŠ¡
- è€ŒåŒæ­¥ä»»åŠ¡ä¸Žå¼‚æ­¥ä»»åŠ¡æ‰§è¡Œçš„æ—¶å€™ï¼Œæ‰§è¡Œçš„æ–¹å¼ä¼šæœ‰åŒºåˆ«ã€‚
   - åŒæ­¥ä»»åŠ¡æ‰§è¡Œè¿›å…¥çš„æ˜¯ä¸»çº¿ç¨‹ï¼Œå¼‚æ­¥ä»»åŠ¡è¿›å…¥Event Tableå¹¶ä¸”æ³¨å†Œå‡½æ•°ã€‚
   - å½“å¼‚æ­¥ä»»åŠ¡ä¸­æŒ‡å®šçš„äº‹æƒ…å®Œæˆä¹‹åŽï¼ŒEvent Tableä¼šå°†è¿™ä¸ªå‡½æ•°ç§»å…¥Event Queueã€‚
   - å½“ä¸»çº¿ç¨‹çš„ä»»åŠ¡éƒ½æ‰§è¡Œå®Œæˆä¹‹åŽï¼Œå°±ä¼šåˆ°Event Queueä¸­è¯»å–å¯¹åº”çš„å‡½æ•°åˆ°ä¸»çº¿ç¨‹æ‰§è¡Œã€‚
```
ðŸŒ°1ï¼š
console.log(1);
setTimeout(()=>{
  console.log(2);
},1000);
console.log(3);

//è¾“å‡ºçš„ç»“æžœä¸º
1
3
2
// å› ä¸ºsetTimeoutæ˜¯å¼‚æ­¥å‡½æ•°å¿…é¡»è¦ç­‰åˆ°åŒæ­¥ä»»åŠ¡å®Œæˆä¹‹åŽæ‰ä¼šæ‰§è¡Œ
ðŸŒ°2ï¼š
let i = 0;
setTimeout(()=>{
  console.log(++i);
},1000);
setTimeout(()=>{
  console.log(++i);
},1000);
//è¾“å‡ºçš„ç»“æžœä¸º
1
2
//å› ä¸ºä»»åŠ¡å…±äº«å†…å­˜
```

### Promiseä¸Žprocess.nextTick(callback)
- å¯¹äºŽä»»åŠ¡æ›´è¿›ä¸€æ­¥å®šä¹‰å¯åˆ†ä¸ºå®ä»»åŠ¡ä¸Žå¾®ä»»åŠ¡ã€‚
   - å®ä»»åŠ¡ï¼šåŒ…æ‹¬æ•´ä½“ä»£ç scriptï¼ŒsetTimeoutï¼ŒsetIntervalï¼ŒDOMæ¸²æŸ“(è‹¥æœ‰ä»»åŠ¡é˜»å¡žå†DOMæ¸²æŸ“ä¹‹å‰ï¼Œå°±ä¼šé€ æˆé¡µé¢ç™½é¡µçš„æƒ…å†µ)
   - å¾®ä»»åŠ¡ï¼šPromiseï¼Œprocess.nextTick
- è€Œä¸åŒç±»åž‹çš„ä»»åŠ¡ä¼šè¿›å…¥å¯¹åº”çš„Event Queueï¼Œä¾‹å¦‚setTimeoutï¼ŒsetIntervalä¼šè¿›å…¥åŒä¸€Event Queueã€‚
- äº‹ä»¶å¾ªçŽ¯æ‰§è¡Œçš„é¡ºåºä¸ºï¼šæ•´ä½“ä»£ç script(å®ä»»åŠ¡) -> å¾®ä»»åŠ¡ -> å®ä»»åŠ¡ -> å¾®ä»»åŠ¡ã€‚(æ¯æ¬¡æ‰§è¡Œå®Œæˆä¸€ä¸ªå®è§‚ä»»åŠ¡éƒ½éœ€è¦æŸ¥çœ‹æ˜¯å¦ç”±å¾®è§‚ä»»åŠ¡åœ¨Event Queueä¸­ï¼Œè‹¥æœ‰å°±è¦æ‰§è¡Œå®Œæˆæ‰€æœ‰å¾®è§‚ä»»åŠ¡ï¼Œå†æ‰§è¡Œä¸‹ä¸€ä¸ªå®è§‚ä»»åŠ¡ï¼Œä»¥æ­¤å¾ªçŽ¯)
```
ðŸŒ°ï¼š
        console.log('1');

        setTimeout(function () {
            console.log('2');
            new Promise(function (resolve) {
                console.log('3');
                resolve();
            }).then(function () {
                console.log('4')
            })
        })

        new Promise(function (resolve) {
            console.log('5');
            resolve();
        }).then(function () {
            console.log('6')
        })
        
        setTimeout(function () {
            console.log('7');
            new Promise(function (resolve) {
                console.log('8');
                resolve();
            }).then(function () {
                console.log('9')
            })
        })
        
        //æ‰§è¡Œçš„ç»“æžœæ˜¯ï¼š1ã€5ã€6ã€2ã€3ã€4ã€7ã€8ã€9
```

- å‚è€ƒï¼š
   > [è¿™ä¸€æ¬¡ï¼Œå½»åº•å¼„æ‡‚ JavaScript æ‰§è¡Œæœºåˆ¶](https://juejin.im/post/59e85eebf265da430d571f89)
