# CPU调度

## 基本概念
- CPU调度：进程调度程序按照一定的策略，动态地将CPU分配给某个进程，并使之使用。
- 目的：使得CPU资源的利用率达到最高。
- 进程的执行时间 = CPU执行时间 + IO等待周期组成。

## 常用术语
- CPU利用率：为CPU的使用率。
- 吞吐量：单位时间中完成的进程。
- 周转时间：运行该进程所花费的时间。
- 等待时间：在就绪队列中等待花费的时间。
- 响应时间：从提交请求到产生第一个响应的时间。

## 调度的算法
### 先到先服务调度(FCFS)
- 系统按照作业到达的优先次序来进行调度，或者说它会优先考虑在系统中等待时间最长的作业，而不管该作业所需执行的时间的长短。
- 有利于CPU繁忙型的作业，而不利于I/O繁忙型的作业。

### 最短作业优先调度(SJF)
- SJF算法是以作业的长短计算优先级的，作业越短其优先级越高，作业的长短是以作业所要求的运行时间来衡量的。
- 作业优先调度分为了两种：
   - 非抢占性：一旦一个进程开始执行了就需要完成这个进程才能执行下一个进程。
   - 抢占性：如果新来的进程CPU区间段比当前的时间段小，则优先选择新的进程(称为SRTF)。
   ```
   🌰：
     进程  到达时间	区间时间
	   P1		 0.0		   7
	   P2		 2.0		   4
	   P3		 4.0		   1
	   P4		 5.0		   4
     
     //非抢占性执行的顺序
     P1->P3->P2->P4
     //平均等待的时间：
     (0+(7-4)+(8-2)+(12-5))/4 = 4
     
     //抢占性执行的顺序
     P1--->P2--->P3--->P2--->P4--->P1
        2     2     1     2     4
     //平均等待的时间
     (9+1+0+2)/4 = 3
   ```

### 优先权调度(SPA)
- 每个进程都有优先权，具有最高优先权的进程分配给CPU。
- 优先权为CPU区间的倒数，CPU区间越大，优先权越小。
- 可能导致的问题：低优先权的进程可能永远也不会执行，无穷的阻塞。
- 解决的方法：逐渐增加在系统中等待时间很长的进程的优先权

### 轮转法调度(RR)
- 每个进程都会得到一个较小的时间单元--时间片，系统给每个进程分配若干个时间片，被调度的进程运行完时间片后，系统就发生调度。
- 如果有n个进程，q个时间片，那么每个进程会得到1/n的CPU时间，每个长度不超过q时间单元。每个进程必须等待CPU的时间不会超过（n-1）q个时间单元，直到下一个时间片为止。
- 会有两种情况：
   1. CPU区间小于时间片
   2. CPU区间大于时间片
- 特点：平均等待时间较高，但响应较好。
```
🌰：
 进程  	区间时间
	P1		 	 53
	P2			 17
	P3		 	 68
	P4			 24
 - 时间片为20
 
 //执行的顺序
 P1-->P2-->P3-->P4-->P1-->P3-->P4-->P1-->P3-->P3
 0    20   37   57   77   97   117  134  154  162
 ```

### 多级队列调度
- 多级队列调度就是将就绪队列分成多个单独队列。根据进程属性，如内存大小、进程优先级、进程类型等，一个进程分到一个队列，每个队列有自己的调度算法。例如，有前台、后台两个队列，前台可以采用RR调度算法，后台采用FCFS调度算法。
- 队列之间也会有调度，例如，按优先权进行调度、按时间片进行调度。

### 多级反馈轮转调度(RRMF)
- 多级反馈轮转调度就是将绪队列分成N个单独队列，每个队列中对于处理优先级的调度算法是不一致的，所以说各个队列中的作业的优先级也是不一致的。一般来说，一般来说，第一个队列的优先级会高于第二个队列，以此类推。而在第一个队列中的作业的优先级也会高于第二个队列中的作业。对于某个特定的队列来说，里面是遵循时间片轮转法。也就是说，位于第二个队列中有N个作业，它们的运行时间是通过这个队列所设定的时间片来确定的。而每个队列中的时间片都是不一样的，各个队列的时间片是随着优先级的增加而减少的，也就是说，优先级越高的队列中它的时间片就越短。

- 参考：
   - [多级反馈队列调度算法](https://blog.csdn.net/yangquanhui1991/article/details/47446151)

### 线性优先级调度(SRR)
- 在轮转法调度时，创建新的进程放入就绪队列末尾享受平等的处理机时间片。
- SRR是对FCFS和RR调度算法的折衷算法。

### 最高响应比优先法(HRN)
- 最高响应优先法是对FCFS方式和SJF方式的综合平衡。
- 响应比定义：R=(W+T)/T=1+W/T  （T为该作业估计需要的执行时间，W为等待时间）







